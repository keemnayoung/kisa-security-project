-- Seed data for kisa_items (OS: U-01 ~ U-67).
-- Source: user-provided KISA items content (with per-item guide).
-- Idempotent via ON DUPLICATE KEY UPDATE.

USE kisa_security;

INSERT INTO kisa_items (item_code, category, title, severity, description, auto_fix, auto_fix_description, guide) VALUES
('U-01', 'account', 'root 계정 원격 접속 제한', '상', '시스템 정책에 root 계정의 원격터미널 접속 차단 설정 적용 여부 점검', 0, '원격 접속을 차단할 경우, 콘솔 접속이 불가능한 환경에서는 관리자 접속 자체가 불가능해질 위험이 있어 자동 조치 기능을 제공하지 않습니다.', '/etc/ssh/sshd_config 파일에서 PermitRootLogin 항목을 no로 설정해야 합니다.'),
('U-02', 'account', '비밀번호 관리정책 설정', '상', '패스워드 최소 길이 및 복잡성(영문, 숫자, 특수문자) 설정 여부 점검', 1, '복잡성 정책을 강제 적용할 경우, 기존의 단순 비밀번호를 사용하는 애플리케이션 연동이 실패하거나 로그인이 불가능해질 수 있으니 주의가 필요합니다.', '/etc/security/pwquality.conf 파일에서 minlen=8, minclass=3 등으로 설정하고, /etc/login.defs 파일 설정을 적용해야 합니다.'),
('U-03', 'account', '계정 잠금 임계값 설정', '상', '로그인 실패 시 계정 잠금 임계값(횟수, 시간) 설정 여부 점검', 1, '임계값을 설정하면 관리자가 실수로 비밀번호를 여러 번 틀렸을 때 계정이 잠겨 긴급 대응이 지연될 수 있으니 주의가 필요합니다.', '/etc/pam.d/password-auth 및 system-auth 파일에서 pam_faillock.so 모듈을 사용하여 deny=5, unlock_time=120으로 설정해야 합니다.'),
('U-04', 'account', '비밀번호 파일 보호', '상', '/etc/shadow 파일의 소유자 및 권한 적절성 점검', 1, '권한을 축소할 경우, shadow 파일을 읽어야 하는 특정 레거시 모니터링 툴이나 애플리케이션의 접근이 차단될 수 있으니 주의가 필요합니다.', '/etc/shadow 파일의 소유자를 root로 변경하고, 권한을 400 이하로 설정해야 합니다.'),
('U-05', 'account', 'root 이외의 UID가 0 금지', '상', 'root 계정 외에 UID가 0인 계정 존재 여부 점검', 1, 'UID 0을 사용하는 특수 목적의 솔루션 계정이 있을 경우, 권한 변경 시 해당 솔루션이 오작동할 위험이 있으니 주의가 필요합니다.', 'UID가 0인 불필요한 계정을 삭제하거나, 해당 계정의 UID를 1000 이상의 다른 값으로 변경해야 합니다.'),
('U-06', 'account', '사용자 계정 su 기능 제한', '상', 'su 명령어를 사용할 수 있는 그룹 제한 여부 점검', 0, '관리자 그룹(wheel)에 계정을 추가하는 선행 작업 없이 차단하면, 일반 계정에서 root 권한 획득이 아예 불가능해질 위험이 있어 자동 조치 기능을 제공하지 않습니다.', '/etc/pam.d/su 파일에서 pam_wheel.so 모듈 주석을 해제하여 wheel 그룹 사용자만 su 명령어를 사용하도록 설정해야 합니다.'),
('U-07', 'account', '불필요한 계정 제거', '하', '시스템 기본 계정 중 불필요한 계정(lp, uucp 등) 존재 여부 점검', 0, '삭제 대상 계정이 실제 레거시 서비스나 데몬 구동에 사용 중인지 시스템이 자동으로 판단하기 어려워 자동 조치 기능을 제공하지 않습니다.', 'lp, uucp, games 등 시스템 운영에 불필요한 기본 계정을 확인하여 삭제해야 합니다.'),
('U-08', 'account', '관리자 그룹에 최소한의 계정 포함', '중', '관리자 그룹(root)에 불필요한 계정 포함 여부 점검', 0, 'GID=0(root)은 권한의 핵심 경계이므로, 변경 시 파일 접근 권한이 달라지거나 외부 연동 정책과 충돌할 위험이 커서 자동 조치 기능을 제공하지 않습니다.', '/etc/group 파일을 확인하여 root 그룹에 불필요하게 포함된 계정을 제거해야 합니다.'),
('U-09', 'account', '계정이 존재하지 않는 GID 금지', '하', '그룹 파일에 계정이 존재하지 않는 빈 그룹 존재 여부 점검', 0, '그룹이 비어 있어도 ACL, 배포 스크립트, 외부 연동(AD/LDAP) 등에서 참조 중일 경우 권한 문제가 발생할 수 있어 자동 조치 기능을 제공하지 않습니다.', '/etc/group 및 /etc/gshadow 파일을 점검하여 사용하지 않는 불필요한 그룹을 삭제해야 합니다.'),
('U-10', 'account', '동일한 UID 금지', '중', '/etc/passwd 파일 내 동일한 UID를 사용하는 중복 계정 존재 여부 점검', 0, '중복된 UID 중 어떤 계정을 유지하고 어떤 것을 변경해야 할지 기계적으로 판단할 수 없으므로 자동 조치 기능을 제공하지 않습니다.', '중복된 UID를 가진 계정을 확인하여, 서로 다른 UID를 갖도록 변경해야 합니다.'),
('U-11', 'account', '사용자 Shell 점검', '하', '로그인이 불필요한 계정에 쉘 부여 여부 점검', 1, '쉘 스크립트 기반으로 구동되는 서비스 계정의 쉘을 제거할 경우 서비스 장애가 발생할 수 있으니 주의가 필요합니다.', '로그인이 필요 없는 계정의 쉘 설정을 /sbin/nologin 또는 /bin/false로 변경해야 합니다.'),
('U-12', 'account', '세션 종료 시간 설정', '하', '일정 시간 유휴 상태 시 세션을 종료하는 설정(TMOUT) 적용 여부 점검', 1, '장시간 모니터링이나 대기 작업이 필요한 관리자 세션이 의도치 않게 종료되어 업무에 불편을 줄 수 있으니 주의가 필요합니다.', '/etc/profile 또는 /etc/bashrc 파일에 TMOUT=600 설정을 추가하고 export 해야 합니다.'),
('U-13', 'account', '안전한 비밀번호 암호화 알고리즘 사용', '중', '패스워드 암호화 시 안전한 알고리즘(SHA512 등) 사용 여부 점검', 1, '구형 OS나 레거시 시스템과 계정 정보를 공유하는 환경에서는 최신 알고리즘 미지원으로 호환성 문제가 발생할 수 있으니 주의가 필요합니다.', '/etc/login.defs 파일의 ENCRYPT_METHOD 항목을 SHA512로 설정해야 합니다.'),
('U-14', 'directory', 'root 홈, 패스 디렉터리 권한 및 패스 설정', '상', 'root 계정의 PATH 환경변수에 "."(현재 디렉터리)이 포함되어 있는지 점검', 0, 'PATH는 시스템 명령 실행 흐름에 직접적인 영향을 미치는 환경 변수이므로, 자동 조치 시 운영 스크립트의 실행 방식 변경 및 예기치 않은 장애를 유발할 수 있어 자동 조치 기능을 제공하지 않습니다.', 'root 계정의 환경변수 설정 파일(/etc/profile 등)에서 PATH에 포함된 "." 또는 "::"을 제거해야 합니다.'),
('U-15', 'directory', '파일 및 디렉터리 소유자 설정', '상', '소유자가 존재하지 않는 파일(nouser)이나 그룹(nogroup)이 존재하는지 점검', 0, '소유자가 없는 파일이라도 다른 서비스에서 사용 중일 수 있어, 자동 조치로 삭제하거나 권한을 변경할 경우 위험할 수 있으므로 자동 조치 기능을 제공하지 않습니다.', 'find 명령어로 소유자가 없는 파일을 검색하여, 불필요한 파일이면 삭제하고 필요한 파일이면 소유자를 변경해야 합니다.'),
('U-16', 'directory', '/etc/passwd 파일 소유자 및 권한 설정', '상', '/etc/passwd 파일의 소유자 및 권한 설정 적절성 점검', 1, '권한을 644보다 낮게 설정할 경우, 일반 사용자가 계정 정보를 읽지 못해 일부 애플리케이션에서 문제가 발생할 수 있으니 주의가 필요합니다.', '/etc/passwd 파일의 소유자를 root로 설정하고, 권한을 644 이하로 설정해야 합니다.'),
('U-17', 'directory', '시스템 시작 스크립트 권한 설정', '상', '/etc/init.d 등 시스템 시작 스크립트 파일의 소유자 및 권한 점검', 0, '시스템 시작 스크립트의 범위가 넓고 일부 서비스는 root 소유가 아니어야 할 수 있어, 자동 조치 시 서비스 상태 불일치가 발생할 수 있으므로 자동 조치 기능을 제공하지 않습니다.', '시스템 시작 스크립트 파일의 소유자를 root로 설정하고, 타 사용자의 쓰기 권한을 제거해야 합니다.'),
('U-18', 'directory', '/etc/shadow 파일 소유자 및 권한 설정', '상', '/etc/shadow 파일의 소유자 및 권한 설정 적절성 점검', 1, '권한 변경 시 shadow 파일을 읽어야 하는 특정 레거시 모니터링 툴이나 백업 솔루션의 접근이 차단될 수 있으니 주의가 필요합니다.', '/etc/shadow 파일의 소유자를 root로 설정하고, 권한을 400 이하로 설정해야 합니다.'),
('U-19', 'directory', '/etc/hosts 파일 소유자 및 권한 설정', '상', '/etc/hosts 파일의 소유자 및 권한 설정 적절성 점검', 1, '권한을 너무 제한적으로 설정할 경우, 일반 사용자가 네트워크 호스트 정보를 조회하지 못해 연결 오류가 발생할 수 있으니 주의가 필요합니다.', '/etc/hosts 파일의 소유자를 root로 설정하고, 권한을 600 이하로 설정해야 합니다.'),
('U-20', 'directory', '/etc/(x)inetd.conf 파일 소유자 및 권한 설정', '상', '/etc/xinetd.conf 및 /etc/inetd.conf 파일의 소유자 및 권한 점검', 1, '파일 권한 변경 시 xinetd 데몬 재시작이 필요할 수 있으며, 잘못된 설정 시 네트워크 서비스가 중단될 수 있으니 주의가 필요합니다.', '/etc/(x)inetd.conf 파일의 소유자를 root로 설정하고, 권한을 600으로 설정해야 합니다.'),
('U-21', 'directory', '/etc/(r)syslog.conf 파일 소유자 및 권한 설정', '상', '로그 설정 파일의 소유자 및 권한 설정 적절성 점검', 1, '로그 설정 파일의 권한을 변경할 경우, 로그 수집 에이전트나 모니터링 툴이 설정 파일을 읽지 못할 수 있으니 주의가 필요합니다.', '/etc/syslog.conf 또는 /etc/rsyslog.conf 파일의 소유자를 root로 설정하고, 권한을 640 이하로 설정해야 합니다.'),
('U-22', 'directory', '/etc/services 파일 소유자 및 권한 설정', '상', '/etc/services 파일의 소유자 및 권한 설정 적절성 점검', 1, '일반 사용자가 서비스를 조회하지 못하게 권한을 과도하게 축소하면, 포트 매핑 확인이 필요한 프로그램이 오작동할 수 있으니 주의가 필요합니다.', '/etc/services 파일의 소유자를 root로 설정하고, 권한을 644 이하로 설정해야 합니다.'),
('U-23', 'directory', 'SUID, SGID, Sticky bit 설정 파일 점검', '상', '주요 파일에 SUID, SGID, Sticky bit 설정 여부 점검', 0, '필수적인 시스템 기능이 SUID에 의존하고 있을 수 있어, 일괄적으로 권한을 제거할 경우 정상적인 시스템 명령어가 작동하지 않을 위험이 있어 자동 조치 기능을 제공하지 않습니다.', '불필요한 SUID, SGID가 설정된 파일을 식별하여, 해당 권한을 제거해야 합니다.'),
('U-24', 'directory', '사용자, 시스템 환경변수 파일 소유자 및 권한 설정', '상', '홈 디렉터리 내 환경변수 파일(.bashrc 등)의 소유자 및 권한 점검', 0, '환경변수 파일은 사용자 업무 영역이자 애플리케이션 실행 환경을 정의하므로, 자동 조치 시 서버 운영에 리스크가 발생할 수 있어 자동 조치 기능을 제공하지 않습니다.', '환경변수 파일의 소유자를 해당 계정 또는 root로 설정하고, 타 사용자의 쓰기 권한을 제거해야 합니다.'),
('U-25', 'directory', 'world writable 파일 점검', '상', '모든 사용자에게 쓰기 권한이 부여된 파일 존재 여부 점검', 0, '일부 프로그램은 의도적으로 권한을 부여해 놓은 경우가 있어, 자동 조치를 하게 되면 일부 서비스 기능이 고장 날 수 있으므로 자동 조치 기능을 제공하지 않습니다.', '시스템에 불필요한 world writable 파일을 찾아 쓰기 권한을 제거해야 합니다.'),
('U-26', 'directory', '/dev에 존재하지 않는 device 파일 점검', '상', '/dev 디렉터리에 device 파일이 아닌 일반 파일 존재 여부 점검', 0, '커스텀 드라이브, 오래된 장비, 가상화 환경에서는 오탐 가능성이 높고 불필요한 파일인지 여부를 기계적으로 판단하기 어려워 자동 조치 기능을 제공하지 않습니다.', '/dev 디렉터리에 존재하는 불필요한 일반 파일을 확인하여 수동으로 삭제해야 합니다.'),
('U-27', 'directory', '$HOME/.rhosts, hosts.equiv 사용 금지', '상', 'r-command 사용을 위한 인증 파일 존재 여부 점검', 1, '레거시 시스템에서 rlogin, rsh 등을 사용 중일 경우, 파일 삭제 시 원격 접속 및 자동화 스크립트가 중단될 수 있으니 주의가 필요합니다.', '/etc/hosts.equiv 및 .rhosts 파일의 소유자를 root 또는 해당 계정으로 변경하고, 권한을 600 이하로 설정하거나 삭제해야 합니다.'),
('U-28', 'directory', '접속 IP 및 포트 제한', '상', '/etc/hosts.allow, hosts.deny 파일 설정 여부 점검', 0, '접속 IP 제한은 접근 제어 정책에 해당하며, 원격 서버일 경우 잘못된 자동 조치 시 해당 서비스를 아예 이용하지 못할 수 있어 자동 조치 기능을 제공하지 않습니다.', '/etc/hosts.deny에 ALL:ALL을 설정하고, /etc/hosts.allow에 접속을 허용할 IP를 등록해야 합니다.'),
('U-29', 'directory', 'hosts.lpd 파일 소유자 및 권한 설정', '하', '/etc/hosts.lpd 파일의 소유자 및 권한 적절성 점검', 1, '프린터 서비스를 사용하는 환경에서 권한 변경 시, 인쇄 작업 요청이 거부될 수 있으니 주의가 필요합니다.', '/etc/hosts.lpd 파일의 소유자를 root로 설정하고, 권한을 600으로 설정해야 합니다.'),
('U-30', 'directory', 'UMASK 설정 관리', '중', '시스템 기본 UMASK 설정 값 적절성 점검', 1, 'UMASK 값을 너무 엄격하게(027 등) 자동 변경할 경우, 새로 생성되는 파일에 대한 그룹/타인 권한이 제한되어 협업이나 파일 공유에 문제가 생길 수 있으니 주의가 필요합니다.', '/etc/profile 등에서 UMASK를 022 이상으로 설정해야 합니다.'),
('U-31', 'directory', '홈 디렉토리 소유자 및 권한 설정', '중', '사용자 홈 디렉터리의 소유자 및 권한 설정 적절성 점검', 0, '일반 사용자 외에도 개발자, 배포, CI/CD, 운영 계정 등 특수 목적 계정이 존재할 수 있으며, 이 경우 권한 변경 시 서비스 장애가 발생할 수 있어 자동 조치 기능을 제공하지 않습니다.', '홈 디렉터리의 소유자를 해당 계정으로 설정하고, 타 사용자의 쓰기 권한을 제거해야 합니다.'),
('U-32', 'directory', '홈 디렉토리로 지정한 디렉토리의 존재 관리', '중', '홈 디렉터리가 존재하지 않는 계정 존재 여부 점검', 0, '계정 삭제는 되돌릴 수 없어 위험하며, 시스템 계정이나 데몬 계정은 보안상 일부러 홈 디렉터리를 두지 않는 경우도 있어 자동 조치 기능을 제공하지 않습니다.', '홈 디렉터리가 없는 불필요한 계정을 점검하여 삭제하거나, 필요한 경우 홈 디렉터리를 생성해야 합니다.'),
('U-33', 'directory', '숨겨진 파일 및 디렉토리 검색 및 제거', '하', '불필요하거나 의심스러운 숨겨진 파일 및 디렉터리 존재 여부 점검', 0, '.ssh, .kube, .config 등 시스템 운영에 필요하지만 숨겨진 파일들이 많으며, 이들은 악성 파일이 아니므로 자동 삭제 시 운영 환경이 파괴될 위험이 있어 자동 조치 기능을 제공하지 않습니다.', 'find 명령어로 숨겨진 파일을 검색하여, 악성 파일이나 불필요한 파일인지 확인 후 수동으로 삭제해야 합니다.'),
('U-34', 'service', 'Finger 서비스 비활성화', '상', 'Finger 서비스의 활성화 여부 점검.', 1, 'Finger 서비스를 비활성화할 경우 시스템 외부에서 사용자 정보를 조회하는 기능이 차단될 수 있으니 주의가 필요합니다.', 'xinetd 설정 파일에서 finger 서비스를 disable 처리하거나 systemctl을 통해 서비스를 중지해야 합니다.'),
('U-35', 'service', '공유 서비스에 대한 익명 접근 제한 설정', '상', 'Anonymous FTP 등 공유 서비스의 익명 접근 제한 여부 점검.', 1, '익명 접속을 차단할 경우 익명 계정을 통한 파일 다운로드나 공개 자료실 서비스 이용이 제한될 수 있으니 주의가 필요합니다.', 'vsftpd.conf 등 FTP 설정 파일에서 anonymous_enable을 NO로 설정하여 익명 접속을 차단해야 합니다.'),
('U-36', 'service', 'r 계열 서비스 비활성화', '상', 'r-command(rlogin, rsh, rexec) 서비스의 활성화 여부 점검.', 1, 'r 계열 서비스 중단 시 보안되지 않은 원격 접속이나 이를 이용한 기존 자동화 스크립트가 작동하지 않을 수 있으니 주의가 필요합니다.', 'xinetd 내의 rlogin, rsh, rexec 서비스를 모두 비활성화하고 관련 데몬을 즉시 중지해야 합니다.'),
('U-37', 'service', 'crontab 설정파일 권한 설정 미흡', '상', 'crontab 관련 파일의 소유자 및 권한 적절성 점검.', 1, '권한을 제한할 경우 적절한 권한이 없는 일반 사용자가 예약 작업을 등록하거나 조회하는 기능이 제한될 수 있으니 주의가 필요합니다.', '/etc/cron.allow 및 /etc/cron.deny 파일의 소유자를 root로 설정하고 권한을 640 이하로 관리해야 합니다.'),
('U-38', 'service', 'DoS 공격에 취약한 서비스 비활성화', '상', 'echo, discard, daytime, chargen 등 DoS 유발 서비스의 활성화 여부 점검.', 1, '해당 서비스들을 비활성화할 경우 네트워크 성능 진단이나 특정 레거시 프로토콜 테스트 작업이 중단될 수 있으니 주의가 필요합니다.', '/etc/xinetd.d/ 내의 관련 서비스 설정 파일에서 disable = yes를 적용하여 서비스를 중지해야 합니다.'),
('U-39', 'service', '불필요한 NFS 서비스 비활성화', '상', 'NFS 서비스의 사용 여부 및 비활성화 상태 점검.', 1, 'NFS 서비스를 중지하면 현재 공유 중인 원격 디렉터리에 접근할 수 없게 되어 데이터 연동 장애가 발생할 수 있으니 주의가 필요합니다.', 'NFS를 사용하지 않는다면 nfs-server(또는 nfs), rpc-statd, rpcbind 등 NFS/RPC 연관 서비스들을 중지하고 부팅 시 실행되지 않도록 비활성화해야 합니다.'),
('U-40', 'service', 'NFS 접근 통제', '상', 'NFS 공유 시 접근 허용 대상이 적절하게 제한되어 있는지 점검.', 1, '접속 허용 대상을 제한할 경우 리스트에 포함되지 않은 클라이언트의 파일 시스템 접근이 거부되어 연결이 끊길 수 있으니 주의가 필요합니다.', '/etc/exports 파일에서 공유 디렉터리에 접근 가능한 특정 호스트 IP 주소(또는 대역)를 명확히 명시해야 합니다.'),
('U-41', 'service', '불필요한 automountd 제거', '상', 'automountd(autofs) 서비스의 활성화 여부 점검.', 1, '자동 마운트 기능을 중지하면 CD-ROM이나 네트워크 드라이브 등 외부 매체의 자동 연결이 지원되지 않으니 주의가 필요합니다.', 'autofs 서비스를 중지하고 systemctl disable 명령을 통해 서비스 실행을 차단해야 합니다.'),
('U-42', 'service', '불필요한 RPC 서비스 비활성화', '상', 'rpcbind, rstatd 등 불필요한 RPC 서비스의 활성화 여부 점검.', 1, 'RPC 서비스 중단 시 이를 기반으로 동작하는 NFS나 NIS 등 연관된 네트워크 서비스들이 오작동할 수 있으니 주의가 필요합니다.', '사용하지 않는 rpcbind, rpc.statd, rusersd 등 RPC 계열 데몬을 식별하여 모두 중지하고 비활성화해야 합니다.'),
('U-43', 'service', 'NIS, NIS+ 점검', '상', '취약한 NIS 서비스의 활성화 여부 점검.', 1, 'NIS 서비스를 비활성화할 경우 중앙 관리되는 계정 정보를 사용하는 서버들에서 로그인이 실패할 수 있으니 주의가 필요합니다.', 'ypserv, ypbind 등 NIS 관련 서비스를 중지하고 보안성이 우수한 LDAP으로의 전환을 권장해야 합니다.'),
('U-44', 'service', 'tftp, talk 서비스 비활성화', '상', 'tftp, talk, ntalk 서비스의 활성화 여부 점검.', 1, 'tftp 차단 시 네트워크 장비의 설정 파일 전송이나 펌웨어 업데이트 등 관리 작업이 제한될 수 있으니 주의가 필요합니다.', '/etc/xinetd.d/ 내의 tftp, talk 설정 파일에서 disable = yes를 적용하여 서비스를 차단해야 합니다.'),
('U-45', 'service', '메일 서비스 버전 점검', '상', 'Sendmail 등 메일 서비스의 버전 적정성 및 사용 여부 점검합.', 0, '메일 서비스를 사용 중인 경우 버전 패치나 확인 실패 건에 대해 관리자가 직접 영향도를 평가하고 조치해야 하므로 자동 조치 기능을 제공하지 않습니다.', '서비스를 사용한다면 최신 버전으로 패치하고, 사용하지 않는다면 Sendmail 등 관련 데몬을 중지하고 비활성화해야 합니다.'),
('U-46', 'service', '일반 사용자의 메일 서비스 실행 방지', '상', '일반 사용자가 메일 큐를 조작하거나 메일을 발송할 수 있는지 점검.', 1, '설정을 변경하면 일반 사용자의 계정에서 실행되는 쉘 스크립트 기반 자동 메일 발송 기능이 차단될 수 있으니 주의가 필요합니다.', 'Sendmail 사용 시 PrivacyOptions(또는 confPRIVACY_FLAGS)에 restrictmailq 및 restrictqrun 옵션을 적용해야 합니다.'),
('U-47', 'service', '스팸 메일 릴레이 제한', '상', '메일 서버가 제3자의 메일 발송 통로로 이용되는지 점검.', 1, '릴레이 대상을 엄격하게 제한할 경우 정상적인 외부 메일 발송이나 도메인 기반 메일 업무에 차질이 생길 수 있으니 주의가 필요합니다.', '/etc/mail/access 파일에 신뢰할 수 있는 대상만 RELAY로 명시하고 access 맵을 생성해야 합니다.'),
('U-48', 'service', 'expn, vrfy 명령어 제한', '중', 'SMTP의 사용자 정보 확인 명령어(expn, vrfy) 활성화 여부 점검.', 1, '명령어를 제한하면 외부 계정 유추는 방지되나 특정 메일 서버 진단 및 모니터링 도구의 정상 동작이 제한될 수 있으니 주의가 필요합니다.', 'Sendmail 사용 시 PrivacyOptions에 noexpn 및 novrfy를 적용해야 합니다.'),
('U-49', 'service', 'DNS 보안 버전 패치', '상', 'DNS(BIND) 서비스의 버전 보안 적정성 및 사용 여부 점검.', 0, 'DNS 서비스 운영 중 버전 미달로 인한 강제 패치는 설정 호환성 문제나 서비스 중단을 야기할 위험이 커서 자동 조치 기능을 제공하지 않습니다.', 'BIND 서비스를 최신 보안 버전으로 업데이트하거나 서비스를 비활성화해야 합니다.'),
('U-50', 'service', 'DNS Zone Transfer 설정', '상', '인가되지 않은 대상에 대한 DNS Zone Transfer 제한 여부 점검.', 1, '전송 제한 시 보조(Slave) DNS 서버와의 동기화가 실패하여 도메인 정보 불일치 장애가 발생할 수 있으니 주의가 필요합니다.', 'named.conf 설정의 allow-transfer 구문을 사용하여 허용된 보조 DNS 서버 IP만 등록해야 합니다.'),
('U-51', 'service', 'DNS 서비스의 취약한 동적 업데이트 설정 금지', '중', 'DNS 동적 업데이트(Dynamic Update)가 적절히 제한되어 있는지 점검.', 1, '업데이트를 차단할 경우 DHCP 환경에서 클라이언트의 IP 변경에 따른 DNS 레코드 자동 갱신이 실패할 수 있으니 주의가 필요합니다.', 'named.conf의 각 zone 설정 내 allow-update { none; }; 설정을 적용해야 합니다.'),
('U-52', 'service', 'Telnet 서비스 비활성화', '중', '보안에 취약한 Telnet 서비스의 활성화 여부 점검.', 1, 'Telnet 차단 시 사전에 SSH 접속 수단이 확보되어 있지 않으면 서버 원격 관리가 완전히 불가능해지니 주의가 필요합니다.', 'telnet 서비스를 중지하고 보안 전송인 SSH 사용으로 대체해야 합니다.'),
('U-53', 'service', 'FTP 서비스 정보 노출 제한', '하', 'FTP 접속 시 출력되는 배너 메시지에 서버 정보 포함 여부 점검.', 1, '배너 문구 변경 시 특정 서버 정보를 식별하여 동작하는 자동화 FTP 클라이언트가 오작동할 수 있으니 주의가 필요합니다.', 'vsftpd.conf 등 FTP 설정 파일에서 ftpd_banner 문구를 수정해야 합니다.'),
('U-54', 'service', '암호화되지 않은 FTP 서비스 비활성화', '중', '보안에 취약한 일반 FTP 서비스의 활성화 여부 점검.', 1, '일반 FTP를 비활성화하면 암호화 통신을 지원하지 않는 구형 시스템과의 파일 전송이 중단될 수 있으니 주의가 필요합니다.', '일반 FTP 서비스를 중지하고 SFTP(SSH) 또는 FTPS로 전환해야 합니다.'),
('U-55', 'service', 'FTP 계정 Shell 제한', '중', 'ftp 계정 등 서비스 계정에 쉘이 부여되어 있는지 점검.', 1, '서비스 계정의 쉘을 제한하면 해당 계정을 이용한 직접 로그인이 차단되어 관련 운영 스크립트가 영향을 받을 수 있으니 주의가 필요합니다.', '/etc/passwd 파일에서 ftp 등 서비스 계정의 쉘을 /sbin/nologin으로 변경해야 합니다.'),
('U-56', 'service', 'FTP 서비스 접근 제어 설정', '하', 'ftpusers 파일 등을 통한 특정 계정의 FTP 접속 제한 여부 점검.', 1, '관리자 계정의 접속을 차단할 경우 원격에서의 신속한 파일 관리 및 장애 해결 작업에 제약이 생길 수 있으니 주의가 필요합니다.', '/etc/ftpusers 등에 접속을 제한할 계정들을 등록해야 합니다.'),
('U-57', 'service', 'Ftpusers 파일 설정', '중', 'ftpusers 파일의 소유자 및 권한 적절성 점검.', 1, '파일 권한을 강화할 경우 비인가자가 접속 제한 목록을 임의로 수정할 수 없으나 특정 환경 설정 도구와 충돌할 수 있으니 주의가 필요합니다.', '/etc/ftpusers 파일의 소유자를 root로 지정하고 권한을 600 이하로 유지해야 합니다.'),
('U-58', 'service', '불필요한 SNMP 서비스 구동 점검', '중', 'SNMP 서비스의 사용 여부 및 비활성화 상태 점검.', 1, 'SNMP 서비스를 중지하면 NMS(네트워크 관리 시스템)에서 해당 서버의 자원 상태 정보를 수집할 수 없으니 주의가 필요합니다.', 'systemctl stop snmpd 명령으로 서비스를 즉시 중단하고 비활성화해야 합니다.'),
('U-59', 'service', '안전한 SNMP 버전 사용', '상', '취약한 버전(v1, v2) 대신 안전한 SNMPv3 사용 여부 점검.', 0, 'SNMPv3 전환은 기존 모니터링 시스템과의 호환성 및 인증 정책에 따라 큰 영향이 있으므로 관리자가 직접 평가해야 합니다.', 'v1/v2c 설정을 제거하고 SNMPv3 사용자 기반으로만 운영되도록 구성해야 합니다.'),
('U-60', 'service', 'SNMP Community String 복잡성 설정', '중', 'SNMP Community String이 기본값(public/private)인지 점검.', 0, '커뮤니티 스트링 강제 변경 시 연동된 모니터링 시스템과의 통신이 즉시 단절되므로 자동 조치 기능을 제공하지 않습니다.', 'snmpd.conf 파일에서 public, private 등 기본 설정값을 복잡한 문자열로 수정해야 합니다.'),
('U-61', 'service', 'SNMP Access Control 설정', '상', 'SNMP 접근 제어(IP 제한, 권한 제한) 설정 여부 점검.', 1, '접근 제어 적용 시 허용 리스트에 없는 모니터링 서버로부터의 데이터 요청이 거부되어 감시 공백이 생길 수 있으니 주의가 필요합니다.', 'snmpd.conf에서 관리 서버 IP 기반으로 접근을 제한해야 합니다.'),
('U-62', 'service', '로그인 시 경고 메시지 설정', '하', '서버 접속 시 보안 경고 메시지(Banner)가 출력되는지 점검.', 1, '경고 메시지는 법적 대응의 근거가 되나 배너 정보를 파싱하는 자동 로그인 매크로 등이 오작동할 수 있으니 주의가 필요합니다.', '/etc/motd, /etc/issue 등에 경고 문구를 설정해야 합니다.'),
('U-63', 'service', 'sudo 명령어 접근 관리', '중', 'sudoers 파일 설정 및 sudo 권한 할당의 적절성 점검.', 1, '권한 회수 시 업무 수행에 필수적인 특정 계정의 권한까지 제한되어 운영 장애가 발생할 수 있으니 주의가 필요합니다.', '/etc/sudoers 파일을 편집하여 신뢰할 수 있는 사용자에게만 최소한의 sudo 권한을 할당해야 합니다.'),
('U-64', 'patch', '주기적 보안 패치 및 벤더 권고사항 적용', '상', '최신 보안 패치 및 벤더 권고사항 적용 여부 점검', 0, '보안 패치 자동 적용 시 운영 중인 서비스가 예기치 않게 변경되거나 재기동될 위험이 있어 자동 조치 기능을 제공하지 않습니다.', '운영체제 및 주요 애플리케이션의 최신 보안 패치를 주기적으로 수행해야 합니다.'),
('U-65', 'log', 'NTP 및 시각 동기화 설정', '중', '시스템의 시간 동기화(NTP) 설정 여부 점검', 0, '시각 동기화 정보 변경 시 인증, 로그, 트랜잭션 처리의 핵심 기준이 바뀌어 심각한 장애가 발생할 수 있으므로 수동 조치가 권장됩니다.', '/etc/ntp.conf 또는 /etc/chrony.conf 파일을 편집하여 타임 서버와 동기화해야 합니다.'),
('U-66', 'log', '정책에 따른 시스템 로깅 설정', '중', 'rsyslog 등 시스템 로깅 설정이 보안 정책에 맞게 설정되어 있는지 점검', 0, '로그 정책은 조직별로 상이하며 설정 적용 시 로그 누락 발생 가능성이 있어 자동 조치를 제공하지 않습니다.', '/etc/rsyslog.conf 파일을 점검하여 주요 로그가 적절히 기록되도록 설정해야 합니다.'),
('U-67', 'log', '로그 디렉터리 소유자 및 권한 설정', '중', '로그 파일이 저장되는 디렉터리의 소유자 및 권한 적절성 점검', 0, '일괄 소유권 변경 시 애플리케이션이 로그를 기록하지 못하는 장애가 발생할 수 있어 수동 조치가 필요합니다.', '로그 디렉터리의 소유자와 권한을 확인하여 비인가자의 접근을 차단해야 합니다.')
AS new
ON DUPLICATE KEY UPDATE
  category=new.category,
  title=new.title,
  severity=new.severity,
  description=new.description,
  auto_fix=new.auto_fix,
  auto_fix_description=new.auto_fix_description,
  guide=new.guide;

